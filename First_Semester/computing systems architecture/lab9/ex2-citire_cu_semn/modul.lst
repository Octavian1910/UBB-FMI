     1                                  bits 32
     2                                  global _conversie
     3                                  
     4                                  segment data use32 class=data public
     5 00000000 01000000                    semn    dd 1
     6 00000004 00000000                    lungime dd 0
     7                                  
     8                                  segment code use32 class=code
     9                                  _conversie:
    10 00000000 55                          push ebp
    11 00000001 89E5                        mov  ebp, esp
    12 00000003 60                          pushad
    13 00000004 FC                          cld                     ; IMPORTANT pentru LODSB
    14                                  
    15 00000005 8B7508                      mov  esi, [ebp+8]       ; char* sir
    16 00000008 8B7D0C                      mov  edi, [ebp+12]      ; int* v
    17                                  
    18 0000000B C705[04000000]0000-         mov  dword [lungime], 0
    18 00000013 0000               
    19 00000015 C705[00000000]0100-         mov  dword [semn], 1
    19 0000001D 0000               
    20 0000001F 31D2                        xor  edx, edx           ; numar curent
    21 00000021 31C9                        xor  ecx, ecx           ; have_digits = 0
    22                                  
    23                                  citeste:
    24 00000023 AC                          lodsb
    25 00000024 3C00                        cmp  al, 0
    26 00000026 7453                        je   final_sir
    27                                  
    28 00000028 3C2D                        cmp  al, '-'
    29 0000002A 741A                        je   minus
    30                                  
    31 0000002C 3C30                        cmp  al, '0'
    32 0000002E 7222                        jb   delim
    33 00000030 3C39                        cmp  al, '9'
    34 00000032 771E                        ja   delim
    35                                  
    36                                      ; cifra
    37 00000034 0FB6D8                      movzx ebx, al
    38 00000037 83EB30                      sub  ebx, '0'
    39 0000003A 6BD20A                      imul edx, edx, 10
    40 0000003D 01DA                        add  edx, ebx
    41 0000003F B901000000                  mov  ecx, 1             ; have_digits = 1
    42 00000044 EBDD                        jmp  citeste
    43                                  
    44                                  minus:
    45 00000046 C705[00000000]FFFF-         mov  dword [semn], -1
    45 0000004E FFFF               
    46 00000050 EBD1                        jmp  citeste
    47                                  
    48                                  delim:
    49 00000052 83F900                      cmp  ecx, 0
    50 00000055 74CC                        je   citeste            ; ignora delimitatori multipli
    51                                  
    52 00000057 89D0                        mov  eax, edx
    53 00000059 0FAF05[00000000]            imul eax, dword [semn]
    54 00000060 8907                        mov  [edi], eax
    55 00000062 83C704                      add  edi, 4
    56 00000065 FF05[04000000]              inc  dword [lungime]
    57                                  
    58 0000006B 31D2                        xor  edx, edx
    59 0000006D 31C9                        xor  ecx, ecx
    60 0000006F C705[00000000]0100-         mov  dword [semn], 1
    60 00000077 0000               
    61 00000079 EBA8                        jmp  citeste
    62                                  
    63                                  final_sir:
    64 0000007B 83F900                      cmp  ecx, 0
    65 0000007E 7411                        je   finish             ; nu salva daca n-ai numar
    66                                  
    67 00000080 89D0                        mov  eax, edx
    68 00000082 0FAF05[00000000]            imul eax, dword [semn]
    69 00000089 8907                        mov  [edi], eax
    70 0000008B FF05[04000000]              inc  dword [lungime]
    71                                  
    72                                  finish:
    73 00000091 61                          popad
    74 00000092 A1[04000000]                mov  eax, [lungime]
    75 00000097 89EC                        mov  esp, ebp
    76 00000099 5D                          pop  ebp
    77 0000009A C3                          ret
