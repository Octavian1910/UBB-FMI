     1                                  bits 32 ; assembling for the 32 bits architecture
     2                                  
     3                                  ; declare the EntryPoint (a label defining the very first instruction of the program)
     4                                  global start        
     5                                  
     6                                  extern exit, fprintf, fopen, fclose
     7                                  import exit msvcrt.dll
     8                                  import fprintf msvcrt.dll
     9                                  import fopen msvcrt.dll
    10                                  import fclose msvcrt.dll
    11                                  
    12                                  ; our data is declared here (the variables needed by our program)
    13                                  segment data use32 class=data
    14                                      ; ...
    15                                  ; Se dau un nume de fisier si un text (definite in segmentul de date). Textul contine litere mici, litere mari, cifre si caractere speciale. Sa se inlocuiasca toate caracterele speciale din textul dat cu caracterul 
    16                                      
    17 00000000 696E7075742E747874-         nume_fisier db "input.txt",0
    17 00000009 00                 
    18 0000000A 416E61206172652031-         text db "Ana are 12 x mere ! x si 12 pere!",0
    18 00000013 322078206D65726520-
    18 0000001C 212078207369203132-
    18 00000025 20706572652100     
    19                                      lens equ $-text
    20 0000002C 7700                        mod_acces db "w",0
    21 0000002E 21402324255E262A28-         caractere db "!@#$%^&*()"
    21 00000037 29                 
    22 00000038 FFFFFFFF                    descriptor dd -1
    23                                      
    24                                      
    25                                  ; our code starts here
    26                                  segment code use32 class=code
    27                                      start:
    28                                          ; ...
    29                                          ;fopen(nume,mod)
    30 00000000 68[2C000000]                    push mod_acces
    31 00000005 68[00000000]                    push nume_fisier
    32 0000000A FF15[00000000]                  call [fopen]
    33 00000010 83C408                          add esp,4*2
    34                                          
    35 00000013 A3[38000000]                    mov [descriptor],eax
    36 00000018 83F800                          cmp eax,0
    37 0000001B 7451                            je finish
    38                                          
    39                                          
    40 0000001D BE00000000                      mov esi,0
    41                                          parcurgere :
    42 00000022 8A86[0A000000]                      mov al , [text + esi]
    43 00000028 3C00                                cmp al , 0
    44 0000002A 7422                                je sub_parcurgere
    45 0000002C BF00000000                          mov edi,0
    46                                              verif_caracter_special :
    47 00000031 8A9F[2E000000]                          mov bl , [caractere + edi ]
    48 00000037 80FB00                                  cmp bl,0
    49 0000003A 740F                                    je sub_verif_caracter_special
    50 0000003C 38C3                                    cmp bl,al
    51 0000003E 7508                                    jne urm
    52                                                  
    53 00000040 B078                                    mov al,'x'
    54 00000042 8886[0A000000]                          mov [text + esi] , al
    55                                                  
    56                                                  urm : 
    57 00000048 47                                      inc edi
    58 00000049 EBE6                                  jmp verif_caracter_special
    59                                                
    60                                                
    61                                                sub_verif_caracter_special:
    62 0000004B 46                                    inc esi
    63 0000004C EBD4                               jmp parcurgere
    64                                             
    65                                             sub_parcurgere:
    66                                             
    67                                             ;fprintf(descriptor,text)
    68 0000004E 68[0A000000]                       push  text
    69 00000053 FF35[38000000]                     push dword [descriptor]
    70 00000059 FF15[00000000]                     call [fprintf]
    71 0000005F 83C408                             add esp , 4*2
    72                                             
    73                                             ;fclose
    74 00000062 FF35[38000000]                     push dword [descriptor]
    75 00000068 FF15[00000000]                     call [fclose]
    76                                                  
    77                                                  
    78                                                  
    79                                                  
    80                                      
    81                                          finish:
    82                                          
    83                                          
    84                                          ; exit(0)
    85 0000006E 6A00                            push    dword 0      ; push the parameter for exit onto the stack
    86 00000070 FF15[00000000]                  call    [exit]       ; call exit to terminate the program
