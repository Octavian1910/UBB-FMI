     1                                  bits 32 ; assembling for the 32 bits architecture
     2                                  
     3                                  ; declare the EntryPoint (a label defining the very first instruction of the program)
     4                                  global start        
     5                                  
     6                                  ; declare external functions needed by our program
     7                                  extern exit, printf,fclose,fread,fopen               ; tell nasm that exit exists even if we won't be defining it
     8                                  import exit msvcrt.dll    ; exit is a function that ends the calling process. It is defined in msvcrt.dll
     9                                                            ; msvcrt.dll contains exit, printf and all the other important C-runtime specific functions
    10                                  
    11                                  import printf msvcrt.dll
    12                                  import fclose msvcrt.dll
    13                                  import fread msvcrt.dll
    14                                  import fopen msvcrt.dll
    15                                                            
    16                                  ; our data is declared here (the variables needed by our program)
    17                                  segment data use32 class=data
    18                                      ; ...
    19                                  
    20                                      ; Se da un fisier text. Sa se citeasca continutul fisierului, sa se determine cifra cu cea mai mare frecventa si sa se afiseze acea cifra impreuna cu frecventa acesteia. Numele fisierului text este definit in se
    21 00000000 696E7075742E747874-         nume_fisier db "input.txt",0
    21 00000009 00                 
    22 0000000A 7200                        mod_acces db "r",0
    23                                      ;        9 8 7 6 5 4 3 2 1 0
    24 0000000C 000000000000000000-         frecv db 0,0,0,0,0,0,0,0,0,0
    24 00000015 00                 
    25                                      len equ 100
    26 00000016 FFFFFFFF                    descriptor dd -1
    27 0000001A 00<rept>                    text times len db 0
    28 0000007E 00000000                    nr_elem dd 0
    29                                      
    30 00000082 00000000                    max_cifra dd 0
    31 00000086 00                          max_frecv_cifra db 0
    32 00000087 436966726120256420-         format db "Cifra %d apare de %d ori ", 0
    32 00000090 617061726520646520-
    32 00000099 2564206F72692000   
    33                                      
    34                                  ; our code starts here
    35                                  segment code use32 class=code
    36                                      start:
    37                                          ; ...
    38                                          
    39                                          
    40 00000000 A3[7E000000]                    mov [nr_elem],eax
    41 00000005 83F800                          cmp eax,0
    42 00000008 7471                            je finish
    43                                          
    44                                          
    45 0000000A BE00000000                      mov esi,0
    46 0000000F 8B0D[7E000000]                  mov ecx,[nr_elem]
    47                                          parcurgere_text:
    48 00000015 8A86[1A000000]                      mov al,[text + esi]
    49 0000001B 2C30                                sub al,'0'
    50 0000001D 0FB6F8                              movzx edi,al
    51 00000020 8087[0C000000]01                    add byte [frecv+edi],1
    52 00000027 46                                  inc esi
    53 00000028 E2EB                            loop parcurgere_text
    54                                          
    55                                          
    56 0000002A B90A000000                      mov ecx,10
    57 0000002F BE00000000                      mov esi,0
    58                                          gasire_cifra_frecv_max:
    59 00000034 8A86[0C000000]                      mov al,[frecv + esi] ;frecventa cifrei curente
    60                                              
    61 0000003A 3A05[86000000]                      cmp al,[max_frecv_cifra]
    62 00000040 720B                                jb urm
    63                                  
    64                                              ;daca e mai mare frecv actualizam
    65 00000042 A2[86000000]                        mov [max_frecv_cifra],al
    66 00000047 8935[82000000]                      mov [max_cifra],esi
    67                                              
    68                                              urm : 
    69 0000004D 46                                    inc esi
    70 0000004E E2E4                             loop gasire_cifra_frecv_max
    71                                           
    72                                           
    73 00000050 0FB605[86000000]                 movzx eax , byte [max_frecv_cifra]
    74                                           ;printf(format,cifra,frecv)
    75 00000057 50                               push eax ; max_frecv_cifra
    76 00000058 FF35[82000000]                   push dword [max_cifra]
    77 0000005E 68[87000000]                     push format
    78 00000063 FF15[00000000]                   call [printf]
    79 00000069 83C40C                           add esp,4*3
    80                                           
    81                                           ;fclose
    82 0000006C FF35[16000000]                   push dword [descriptor]
    83 00000072 FF15[00000000]                   call [fclose]
    84 00000078 83C404                           add esp , 4*1
    85                                           
    86                                           
    87                                           
    88                                              
    89                                              
    90                                          
    91                                          finish:
    92                                          ; exit(0)
    93 0000007B 6A00                            push    dword 0      ; push the parameter for exit onto the stack
    94 0000007D FF15[00000000]                  call    [exit]       ; call exit to terminate the program
