     1                                  bits 32 ; assembling for the 32 bits architecture
     2                                  
     3                                  ; declare the EntryPoint (a label defining the very first instruction of the program)
     4                                  global start        
     5                                  
     6                                  ; declare external functions needed by our program
     7                                  extern exit,fopen  ,fclose , printf ,fread            ; tell nasm that exit exists even if we won't be defining it
     8                                  import exit msvcrt.dll    ; exit is a function that ends the calling process. It is defined in msvcrt.dll
     9                                                            ; msvcrt.dll contains exit, printf and all the other important C-runtime specific function\s
    10                                  import fopen msvcrt.dll
    11                                  import fclose msvcrt.dll
    12                                  import printf msvcrt.dll
    13                                  import fread msvcrt.dll
    14                                  ; our data is declared here (the variables needed by our program)
    15                                  segment data use32 class=data
    16                                      ; ...
    17                                  ; Se da un fisier text. Sa se citeasca continutul fisierului, sa se contorizeze numarul de cifre pare si sa se afiseze aceasta valoare. Numele fisierului text este definit in segmentul de date.
    18                                  
    19 00000000 696E7075742E747874-         nume_fisier db "input.txt",0
    19 00000009 00                 
    20 0000000A 7200                        mod_acces db "r",0
    21                                      len equ 100
    22 0000000C 00<rept>                    text times len db 0
    23 00000070 FFFFFFFF                    descriptor dd -1
    24                                      
    25 00000074 00000000                    len_text dd 0
    26 00000078 00000000                    rezultat dd 0
    27 0000007C 256400                      format db "%d",0
    28                                      
    29                                  ; our code starts here
    30                                  segment code use32 class=code
    31                                      start:
    32                                          ; ...
    33                                          
    34                                          ;deschidere fisier
    35                                          ;fopen (nume_fisier,mod_acces)
    36 00000000 68[0A000000]                     push mod_acces
    37 00000005 68[00000000]                     push nume_fisier
    38 0000000A FF15[00000000]                   call [fopen]
    39 00000010 83C408                           add esp ,4*2
    40                                           
    41 00000013 A3[70000000]                     mov [descriptor],eax
    42 00000018 83F800                           cmp eax,0
    43 0000001B 7468                             je finish ;nu a mers citirea
    44                                           
    45                                           ; citim textul in fisierul deschis folosind functia fread
    46                                           ; eax = fread(text, 1, len, descriptor_fis)
    47                                           
    48 0000001D FF35[70000000]                   push dword [descriptor]
    49 00000023 6A64                             push len
    50 00000025 6A01                             push 1
    51 00000027 68[0C000000]                     push text
    52 0000002C FF15[00000000]                   call [fread]
    53 00000032 83C410                           add esp,4*4
    54                                           
    55                                           ;in eax avem nr de caractere cittie
    56                                           
    57 00000035 A3[74000000]                     mov [len_text],eax
    58                                           
    59 0000003A 8B0D[74000000]                   mov ecx,[len_text]
    60 00000040 BE00000000                       mov esi,0 
    61                                           
    62                                           loop_text : 
    63 00000045 8A86[0C000000]                      mov al,[text + esi]
    64 0000004B 2C30                                sub al,"0"
    65                                  
    66 0000004D 3C00                                cmp al,0
    67 0000004F 720E                                jb final_loop_text
    68                                              
    69 00000051 3C09                                cmp al,9
    70 00000053 770A                                ja final_loop_text
    71                                              
    72 00000055 A801                                test al,1
    73 00000057 7406                                jz final_loop_text ; nu trb contorizat e par
    74                                          
    75 00000059 FF05[78000000]                      inc dword [rezultat] ;inseamna ca e impar
    76                                              
    77                                              final_loop_text :
    78 0000005F 46                                  inc esi
    79 00000060 E2E3                             loop loop_text
    80                                           
    81                                           
    82                                           ;printf(format,valoare)
    83                                           
    84 00000062 FF35[78000000]                   push dword [rezultat]
    85 00000068 68[7C000000]                     push format
    86 0000006D FF15[00000000]                   call [printf]
    87 00000073 83C408                           add esp,4*2
    88                                           
    89                                       
    90                                           ;pt a inchide fisierul 
    91                                           ;fclose(descriptor)
    92 00000076 FF35[70000000]                   push dword [descriptor]
    93 0000007C FF15[00000000]                   call [fclose]
    94 00000082 83C404                           add esp,4*1
    95                                           
    96                                           
    97                                          finish:
    98                                          ; exit(0)
    99 00000085 6A00                            push    dword 0      ; push the parameter for exit onto the stack
   100 00000087 FF15[00000000]                  call    [exit]       ; call exit to terminate the program
