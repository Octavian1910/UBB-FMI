     1                                  bits 32 ; assembling for the 32 bits architecture
     2                                  
     3                                  ; declare the EntryPoint (a label defining the very first instruction of the program)
     4                                  global start        
     5                                  
     6                                  ; declare external functions needed by our program
     7                                  extern exit , fprintf , fopen , fclose , scanf              ; tell nasm that exit exists even if we won't be defining it
     8                                  import exit msvcrt.dll    ; exit is a function that ends the calling process. It is defined in msvcrt.dll
     9                                                            ; msvcrt.dll contains exit, printf and all the other important C-runtime specific functions
    10                                  import fprintf msvcrt.dll
    11                                  import fopen msvcrt.dll
    12                                  import fclose msvcrt.dll
    13                                  import scanf msvcrt.dll
    14                                                            
    15                                                            
    16                                  ; our data is declared here (the variables needed by our program)
    17                                  segment data use32 class=data
    18                                      ; ...
    19                                      
    20                                      
    21                                  ; Se da un nume de fisier (definit in segmentul de date). Sa se creeze un fisier cu numele dat, apoi sa se citeasca de la tastatura cuvinte si sa se scrie in fisier cuvintele citite pana cand se citeste de la tastat
    22                                  
    23 00000000 696E7075742E747874-         nume_fisier db "input.txt" , 0
    23 00000009 00                 
    24 0000000A 6100                        mod_acces db "a",0
    25                                      
    26 0000000C 257300                      format db "%s",0
    27                                      
    28 0000000F FFFFFFFF                    descriptor dd -1
    29                                      
    30 00000013 00<rept>                    n times 100 db 0
    31                                      
    32 00000077 25732000                    format2 db "%s ",0
    33                                      
    34                                  ; our code starts here
    35                                  segment code use32 class=code
    36                                      start:
    37                                          ; ...
    38                                          
    39                                          ;fopen(nume,mod)
    40 00000000 68[0A000000]                    push mod_acces
    41 00000005 68[00000000]                    push nume_fisier
    42 0000000A FF15[00000000]                  call [fopen]
    43 00000010 83C408                          add esp,4*2
    44                                          
    45 00000013 A3[0F000000]                    mov [descriptor],eax
    46 00000018 83F800                          cmp eax,0
    47 0000001B 7437                            je finish
    48                                          
    49                                          scriere_in_fisier:
    50                                          
    51                                              ;scanf(format , n)
    52 0000001D 68[13000000]                        push n
    53 00000022 68[0C000000]                        push format
    54 00000027 FF15[00000000]                      call [scanf]
    55 0000002D 83C408                              add esp,4*2
    56                                             
    57 00000030 803D[13000000]24                   cmp byte [n],'$'
    58 00000037 741B                               je finish
    59                                              
    60                                              ;fprintf(descriptor,format2,text)
    61 00000039 68[13000000]                        push n
    62 0000003E 68[77000000]                        push format2
    63 00000043 FF35[0F000000]                      push dword [descriptor]
    64 00000049 FF15[00000000]                      call [fprintf]
    65 0000004F 83C40C                              add esp,4*3
    66                                              
    67                                              
    68 00000052 EBC9                              jmp scriere_in_fisier
    69                                              
    70                                              
    71                                              
    72                                              
    73                                            
    74                                           
    75                                              
    76                                           
    77                                              
    78                                          finish :
    79                                          
    80                                          
    81                                          ;fclose
    82                                          
    83 00000054 FF35[0F000000]                  push dword [descriptor]
    84 0000005A FF15[00000000]                  call [fclose]
    85                                          
    86                                          ; exit(0)
    87 00000060 6A00                            push    dword 0      ; push the parameter for exit onto the stack
    88 00000062 FF15[00000000]                  call    [exit]       ; call exit to terminate the program
