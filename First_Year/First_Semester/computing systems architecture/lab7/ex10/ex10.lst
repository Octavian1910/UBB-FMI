     1                                  bits 32 ; assembling for the 32 bits architecture
     2                                  
     3                                  ; declare the EntryPoint (a label defining the very first instruction of the program)
     4                                  global start        
     5                                  
     6                                  ; declare external functions needed by our program
     7                                  extern exit  , fprintf ,scanf ,gets  ,fopen,fclose            ; tell nasm that exit exists even if we won't be defining it
     8                                  import exit msvcrt.dll
     9                                  import fprintf msvcrt.dll
    10                                  import scanf msvcrt.dll
    11                                  import gets msvcrt.dll
    12                                  import fopen msvcrt.dll
    13                                  import fclose msvcrt.dll
    14                                  
    15                                  ; our data is declared here (the variables needed by our program)
    16                                  segment data use32 class=data
    17                                      ; ...
    18                                  ; Sa se citeasca de la tastatura un nume de fisier si un text. Sa se creeze un fisier cu numele dat in directorul curent si sa se scrie textul in acel fisier. Observatii: Numele de fisier este de maxim 30 de caracte
    19                                      
    20                                  
    21 00000000 257300                  format1 db "%s",0
    22 00000003 257300                  format2 db "%s",0
    23                                  
    24                                  
    25 00000006 7700                    mod_acces db "w",0
    26 00000008 FFFFFFFF                descriptor dd -1
    27                                  
    28 0000000C 00<rept>                nume times 30 db 0    
    29 0000002A 00<rept>                text times 120 db 0    
    30                                  
    31                                  
    32                                  
    33                                  ; our code starts here
    34                                  segment code use32 class=code
    35                                      start:
    36                                          ; ...
    37                                          
    38                                          ;scanf(format ,nume n)
    39 00000000 68[0C000000]                    push nume 
    40 00000005 68[00000000]                    push format1
    41 0000000A FF15[00000000]                  call [scanf]
    42 00000010 83C408                          add esp,4*2
    43                                          
    44                                          ;gets(text)
    45 00000013 68[2A000000]                    push text 
    46 00000018 FF15[00000000]                  call [gets]
    47 0000001E 83C404                          add esp,4*1
    48                                          
    49                                          ;fopen(nume_fisier,mod_acces)
    50 00000021 68[06000000]                    push mod_acces
    51 00000026 68[0C000000]                    push nume
    52 0000002B FF15[00000000]                  call [fopen]
    53 00000031 83C408                          add esp,4*2
    54                                          
    55 00000034 A3[08000000]                    mov [descriptor] , eax
    56 00000039 83F800                          cmp eax,0
    57 0000003C 7420                            je finish
    58                                          
    59                                          ;fprintf(descriptor,text)
    60 0000003E 68[2A000000]                    push text
    61 00000043 FF35[08000000]                  push dword [descriptor]
    62 00000049 FF15[00000000]                  call [fprintf]
    63 0000004F 83C408                          add esp,4*2
    64                                          
    65                                          ;fclose
    66 00000052 FF35[08000000]                  push dword [descriptor]
    67 00000058 FF15[00000000]                  call [fclose]
    68                                          
    69                                          
    70                                          
    71                                          
    72                                          
    73                                          
    74                                          
    75                                          finish :
    76                                          ; exit(0)
    77 0000005E 6A00                            push    dword 0      ; push the parameter for exit onto the stack
    78 00000060 FF15[00000000]                  call    [exit]       ; call exit to terminate the program
